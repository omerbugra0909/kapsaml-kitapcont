
@model List<kapsamlıkitapcont.Models.Kitap>

<div class="container py-4">
    <div class="d-flex align-items-center justify-content-between mb-3">
        <div>
            <h1 class="h3 mb-0">Kitaplar</h1>
            <p class="text-muted small mb-0">Kütüphanenizdeki tüm kitapları burada görüntüleyebilir, düzenleyebilir veya silebilirsiniz.</p>
        </div>
        <div>
            <a asp-action="Create" class="btn btn-success shadow-sm">
                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-plus-lg me-1" viewBox="0 0 16 16">
                    <path d="M8 1a.5.5 0 0 1 .5.5V7.5H14.5a.5.5 0 0 1 0 1H8.5V14.5a.5.5 0 0 1-1 0V8.5H1.5a.5.5 0 0 1 0-1H7.5V1.5A.5.5 0 0 1 8 1z"/>
                </svg>
                Yeni Kitap Ekle
            </a>
        </div>
    </div>

    <div class="card shadow-sm">
        <div class="card-body">
            <div class="row mb-3 align-items-center">
                <div class="col-md-6 mb-2 mb-md-0">
                    <div class="input-group">
                        <span class="input-group-text bg-white border-end-0"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-search" viewBox="0 0 16 16"><path d="M10.442 10.442a1 1 0 0 1 1.415 0l3.85 3.85a1 1 0 0 1-1.415 1.415l-3.85-3.85a1 1 0 0 1 0-1.415z"/><path d="M6.5 12a5.5 5.5 0 1 1 0-11 5.5 5.5 0 0 1 0 11zm0-1A4.5 4.5 0 1 0 6.5 2a4.5 4.5 0 0 0 0 9z"/></svg></span>
                        <input id="filter" class="form-control border-start-0" placeholder="Kitap adına, yazara veya yıla göre ara..." />
                    </div>
                </div>
                <div class="col-md-6 text-md-end">
                    <span class="text-muted">Toplam: <span id="rowCount" class="fw-semibold">@Model?.Count() ?? 0</span></span>
                </div>
            </div>

            @if (Model == null || !Model.Any())
            {
                <div class="text-center py-5 text-muted">
                    <p class="mb-1">Henüz kayıtlı kitap yok.</p>
                    <a asp-action="Create" class="btn btn-outline-primary">İlk kitabı ekle</a>
                </div>
            }
            else
            {
                <div class="table-responsive">
                    <table class="table table-striped table-hover align-middle mb-0">
                        <thead class="table-light">
                            <tr>
                                <th class="d-none d-sm-table-cell">#</th>
                                <th>Ad</th>
                                <th>Yazar</th>
                                <th class="d-none d-md-table-cell">Yayın Yılı</th>
                                <th class="text-end">İşlemler</th>
                            </tr>
                        </thead>
                        <tbody id="booksTable">
                            @foreach (var kitap in Model)
                            {
                                <tr>
                                    <td class="d-none d-sm-table-cell text-muted">@kitap.Id</td>
                                    <td>@kitap.Ad</td>
                                    <td>@kitap.Yazar</td>
                                    <td class="d-none d-md-table-cell">@kitap.YayinYili</td>
                                    <td class="text-end">
                                        <a asp-action="Edit" asp-route-id="@kitap.Id" class="btn btn-sm btn-outline-primary me-1">Düzenle</a>
                                        <a asp-action="Delete" asp-route-id="@kitap.Id" class="btn btn-sm btn-outline-danger">Sil</a>
                                    </td>
                                </tr>
                            }
                        </tbody>
                    </table>
                </div>
            }
        </div>
    </div>
</div>

<style>
    .card { border: 0; border-radius: .6rem; }
    .input-group-text svg { opacity: .7; }
</style>

<script>
    document.addEventListener('DOMContentLoaded', function () {
        const filter = document.getElementById('filter');
        const table = document.getElementById('booksTable');
        const rowCount = document.getElementById('rowCount');

        function updateCount() {
            const visible = Array.from(table.querySelectorAll('tr')).filter(r => r.style.display !== 'none').length;
            rowCount.textContent = visible;
        }

        filter.addEventListener('input', function () {
            const q = this.value.trim().toLowerCase();
            Array.from(table.querySelectorAll('tr')).forEach(tr => {
                const text = tr.textContent.toLowerCase();
                tr.style.display = q === '' || text.includes(q) ? '' : 'none';
            });
            updateCount();
        });
    });
</script>

